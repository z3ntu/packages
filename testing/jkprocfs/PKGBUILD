# Maintainer: Stephen Gilles <stephendgilles@gmail.com>
# Author: Jeremie Koenig <jk@jk.fr.eu.org>
# Contributor: Diegonc <dnietoc@gmail.com>

pkgname=jkprocfs
pkgver=$( date +%Y%m%d )
pkgrel=1
pkgdesc="An alternate procfs implementation by Jeremie Koenig"
arch=('i686')
url="github.com/jeremie-koenig/hurd"
license=('GPL')

build() {
  cd ${srcdir}
  
  # see http://thread.gmane.org/gmane.os.hurd.bugs/19740
  if [ -d hurd ]; then
    cd hurd
    git pull
  else
    git clone git://github.com/jeremie-koenig/hurd.git
    cd hurd
  fi
  
  ./configure --prefix= --without-parted
  make prefix=${pkgdir} procfs
}

package() {
  cd ${srcdir}/hurd/procfs
  make prefix=${pkgdir} install procfs

  # /hurd/procfs is owned by the mammoth hurd, so we must avoid conflict
  mv ${pkgdir}/hurd/procfs ${pkgdir}/hurd/jkprocfs  
}
